from ete3 import Tree

with open('./new_fusang/njmerge.tre', 'r') as f:
    fusang_str = f.readline()
    fusang_str = fusang_str.strip()

fusang_tree = Tree(fusang_str)

with open('./simulation/fasta_file/t_sim1_TRUE.fas.treefile', 'r') as f:
    iqtree_str = f.readline()
    iqtree_str = iqtree_str.strip()

iqtree_tree = Tree(iqtree_str)

true_tree = Tree('((((((0:0.008,(61:0.0224,(68:0.0081,33:0.1104):0.0085):0.0341):0.0088,(35:0.0084,(89:0.0133,(12:0.0072,(3:0.008,52:0.0086):0.0077):0.0073):0.0096):0.0071):0.0091,(((18:0.0239,(92:0.0073,(67:0.0072,80:0.042):0.0211):0.0232):0.0073,38:0.0193):0.0124,(((40:0.0501,47:0.0916):0.0096,(75:0.0075,36:0.0073):0.0071):0.0169,((((82:0.008,(29:0.0182,98:0.0075):0.0071):0.0332,((41:0.0071,(97:0.0074,31:0.0204):0.0071):0.0212,(66:0.0543,70:0.0109):0.0153):0.0146):0.008,20:0.0213):0.0072,((5:0.0191,65:0.0242):0.0074,(77:0.0115,(93:0.0287,(78:0.0251,(64:0.0091,(22:0.0082,86:0.0646):0.0192):0.0072):0.0071):0.0189):0.0135):0.0082):0.0228):0.0201):0.0189):0.0078,(((1:0.0258,17:0.0207):0.014,((2:0.016,56:0.0255):0.0085,(7:0.0105,53:0.0078):0.0071):0.0469):0.0185,(27:0.0131,91:0.0392):0.0126):0.0156):0.0234,(((25:0.0213,57:0.0073):0.0071,(14:0.017,72:0.0323):0.0093):0.0185,(((34:0.018,11:0.0078):0.0139,59:0.0259):0.0538,((84:0.0499,15:0.0082):0.0083,(((81:0.0074,(60:0.0263,(79:0.0231,(58:0.0799,55:0.0073):0.0206):0.0123):0.0218):0.0111,45:0.0665):0.0072,62:0.0178):0.0114):0.0138):0.011):0.02):0.0152,(((46:0.0649,85:0.0078):0.0255,(8:0.0664,95:0.0199):0.1001):0.0075,((54:0.0075,(51:0.0143,(73:0.0077,(39:0.0104,88:0.0094):0.0071):0.0267):0.0071):0.033,((96:0.0071,69:0.0192):0.0073,(21:0.0073,(9:0.0096,49:0.0328):0.0425):0.0116):0.0075):0.0081):0.0082,((((63:0.0073,6:0.0084):0.0075,(76:0.0077,(16:0.0071,24:0.0098):0.0143):0.0071):0.0205,((50:0.0071,42:0.0083):0.0413,((23:0.0073,(83:0.0088,28:0.0145):0.0086):0.0115,(19:0.009,30:0.0115):0.0629):0.0152):0.0162):0.0374,(((43:0.0691,(71:0.0071,(4:0.0128,44:0.0076):0.0239):0.026):0.0091,(74:0.0459,37:0.0862):0.0232):0.0398,((32:0.0071,(99:0.0071,26:0.017):0.0524):0.0176,(10:0.0163,(48:0.0151,(13:0.0235,(94:0.0149,(90:0.0075,87:0.0083):0.0342):0.0071):0.0105):0.0191):0.0108):0.0153):0.0071):0.0177);')

with open('./RAxML_bestTree.a', 'r') as f:
    raxml_str = f.readline()
    raxml_str = raxml_str.strip()

raxml_tree = Tree(raxml_str)


print('RF distance between fusang and true tree:')
print(fusang_tree.robinson_foulds(true_tree,unrooted_trees=True)[0])
print('RF distance between iqtree and true tree:')
print(iqtree_tree.robinson_foulds(true_tree,unrooted_trees=True)[0])
print('RF distance between raxml and true tree:')
print(raxml_tree.robinson_foulds(true_tree,unrooted_trees=True)[0])
